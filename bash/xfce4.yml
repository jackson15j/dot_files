---
- name: Running the xfce4 window manager ansible playbook...
  hosts: localhost
  tasks:
    - name: Symlink xfce4 config directories to ~/.config/
      file:
        src: '{{playbook_dir}}/{{item}}'
        dest: '~/.config/{{item}}'
        state: link
        force: yes
      with_items:
        - xfce4
        - redshift

    - name: Install xfce4 packages and dependencies
      # https://wiki.archlinux.org/index.php/Xfce
      become: true
      become_method: sudo
      pacman:
        name:
          - xfce4
          - xfce4-goodies
          - network-manager-applet  # Panel applet. TODO: find an xfce variant.
          - blueman  # https://github.com/blueman-project/blueman, BT management.
          - redshift # https://wiki.archlinux.org/index.php/Redshift
          - arandr  # Easy tool to output xrandr displays.
          - xreader  # PDF/document viewer alternative to gnome's `evince`.
          - gnome-keyring  # Can't find a non-gnome variant.
          - seahorse  # GUI to modify the keyring.
        state: latest

    - name: Install VPN AUR packages
      aur: name="{{item}}" tool=yaourt
      with_items:
        - networkmanager-sstp  # FIXME: put in work ansible. Along with /etc/NetworkManager/system-connections/<work-sstp-vpn>

    - name: Enable RedShift night temperature service
      systemd:
        name: redshift-gtk.service
        enabled: True
        state: started
        scope: user

    - name: Symlink .screenlayout directory to ~/.screenlayout
      # xfce is rubbish with hotplugging multiple displays. So lets use arandr
      # to quickly generate the xrandr line to fix this up with a script.
      # TODO: display detection to get our scripts called on hotplug.
      file:
        src: '{{playbook_dir}}/.screenlayout'
        dest: ~/.screenlayout
        state: link
        force: yes
